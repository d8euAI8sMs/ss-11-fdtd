\documentclass[12pt,a4paper]{article}
\usepackage{russ}
\usepackage[english,russian]{babel}
\usepackage{microtype}
\usepackage{csquotes}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{mathtext}
\usepackage[notrig,italicdiff]{physics}
\usepackage{newfloat}
\usepackage{caption}
\usepackage{indentfirst}
\usepackage{geometry}
\usepackage{hyperref}
\usepackage{mdframed}
\usepackage[inline]{enumitem}
\usepackage{graphicx}
\usepackage{subfig}
\geometry{left=1cm,right=1cm,top=2cm,bottom=2cm}
\DeclareGraphicsExtensions{.pdf,.png,.jpg,.PNG}
\graphicspath{{./img/}}
\captionsetup[figure]{justification=centering}
\renewcommand{\thesubfigure}{\asbuk{subfigure}}
\DeclareCaptionLabelSeparator{dotseparator}{. }
\captionsetup{labelsep=dotseparator}

\begin{document}

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Постановка задачи}

        Исследовать дифракцию электромагнитной волны точечного источника на узкой щели.

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Физическая модель}

        Точечный источник будем моделировать в виде Гауссова импульса положительной полярности с периодом повторения $t_0$. Щелью будем считать узкий вырез в ширме из идеального изолятора. Будем рассматривать плоский случай, причем только $TE$-поляризацию электромагнитного поля: отличны от нуля только компоненты $E_z$ (нормальна к плоскости моделирования), $H_x$ и $H_y$ (лежат в плоскости моделирования). Среду будем считать немагнитной, однородной. Токами утечки пренебрежем.

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Математическая модель}

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsection{Уравнения Максвелла}

            Электромагнитное поле в немагнитной среде без потерь в системе единиц СИ описывается уравнениями Максвелла:
            %
            \begin{subequations}\begin{align}
                    \pdv{\vb{E}}{t} &= \frac{1}{\varepsilon_0\varepsilon_r} \nabla\times \vb{H} , \\
                    \pdv{\vb{H}}{t} &= - \frac{1}{\mu_0} \nabla\times \vb{E} .
            \end{align}\end{subequations}
            %

            Уравнения выше могут выглядеть более симметрично. Введем замену
            %
            \begin{align*}
                \vb{E} &\mapsto \sqrt{\frac{\varepsilon_0}{\mu_0}} \vb{E} , \\
                \vb{D} &\mapsto \sqrt{\frac{1}{\varepsilon_0 \mu_0}} \vb{D} .
            \end{align*}
            %
            Это приводит к
            %
            \begin{subequations}\begin{align}
                \pdv{\vb{E}}{t} &= \frac{1}{\sqrt{\varepsilon_0 \mu_0}} \frac{1}{\varepsilon_r} \nabla\times \vb{H} , \\
                \pdv{\vb{H}}{t} &= - \frac{1}{\sqrt{\varepsilon_0 \mu_0}} \nabla\times \vb{E} .
            \end{align}\end{subequations}

            Перейдем к координатной записи, рассматривая только $TE$-поляризованное поле:
            %
            \begin{subequations}\label{eq:maxwell}\begin{align}
                \pdv{E_z}{t} &= \frac{1}{\sqrt{\varepsilon_0 \mu_0}} \frac{1}{\varepsilon_r} \qty(\pdv{H_y}{x} - \pdv{H_x}{y}) , \\
                \pdv{H_x}{t} &= - \frac{1}{\sqrt{\varepsilon_0 \mu_0}} \pdv{E_z}{y} , \\
                \pdv{H_y}{t} &= \frac{1}{\sqrt{\varepsilon_0 \mu_0}} \pdv{E_z}{x} .
            \end{align}\end{subequations}
            %
            Полученные уравнения мы будем далее использовать для построения сеточных уравнений.

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsection{Гауссов импульс}

            Для моделирования источника электромагнитного излучения мы будем использовать периодический Гауссов импульс положительной полярности:
            %
            \begin{equation}
                E_z(t) = E_0 \exp\qty(- \frac{(t - \flatfrac{t_0}{2})^2}{2 \tau^2}) ; \quad
                E_z(t + t_0) = E_z(t) .
            \end{equation}
            %
            Параметром импульса является его дисперсия $\tau$. Величина $6\tau$ может быть использована для оценки полной ширины импульса, поэтому можно положить $T_0 = 6\tau$ без каких-либо серьезных искажений.

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Численная модель}

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsection{Дискретная модель}

            Для простоты будем использовать равномерную сетку по координатам $x$ и $y$ с шагом $\Delta x$. Ячейку, построенную на узлах $(i,j), (i,j+1), (i+1,j), (i+1,j+1)$ будем обозначать по ее опорной вершине $(i,j)$. Шаг по времени $\Delta t$ также выберем равномерным.

            Для повышения точности разностной схемы будем вычислять $H_x$ и $H_y$ в целые моменты времени, а $E_z$~--- в полуцелые. Это возможно в силу того, что $E_z$ вычисляется через $H_x$ и $H_y$, которые, в свою очередь, вычисляются через $E_z$. Кроме того, $E_z$ будем вычислять в узлах сетки, тогда как $H_x$ и $H_y$~--- в серединах соответствующих сторон ячейки. Все это приведет нас в итоге к разностной схеме второго порядка точности как по времени, так и по координатам.

            Итак,
            %
            \begin{subequations}\label{eq:fields_arr}\begin{alignat}{8}
                ez[n,i,j] &= E_z&&[n-1/2&&;i&&;j&&] , \\
                hx[n,i,j] &= H_x&&[n&&;i&&;j-1/2&&] , \\
                hy[n,i,j] &= H_y&&[n&&;i-1/2&&;j&&] .
            \end{alignat}\end{subequations}

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsection{Построение разностной схемы. Метод FDTD}

            Перейдем к построению разностной схемы. Заменим все производные в \autoref{eq:maxwell} односторонними конечными разностями, все непрерывные величины дискретными. Для простоты будем использовать обозначения из \autoref{eq:fields_arr}:
            %
            \begin{subequations}\label{eq:maxwell_fd}\begin{align}
                \begin{split}
                    \frac{ez[n+1,i,j] - ez[n,i,j]}{\Delta t} ={}
                    &\frac{1}{\sqrt{\varepsilon_0 \mu_0}} \frac{1}{\varepsilon_r}
                        \qty(\frac{hy[n,i+1,j] - hy[n,i,j]}{\Delta x}) \\
                    -&\frac{1}{\sqrt{\varepsilon_0 \mu_0}} \frac{1}{\varepsilon_r}
                        \qty(\frac{hx[n,i,j+1] - hx[n,i,j]}{\Delta x})
                \end{split} , \\
                \frac{hx[n+1,i,j] - hx[n,i,j]}{\Delta t} =&
                    {-} \frac{1}{\sqrt{\varepsilon_0 \mu_0}} \frac{ez[n,i,j+1] - ez[n,i,j]}{\Delta x} , \\
                \frac{hy[n+1,i,j] - hy[n,i,j]}{\Delta t} =&
                    \hphantom{{-}} \frac{1}{\sqrt{\varepsilon_0 \mu_0}} \frac{ez[n,i+1,j] - ez[n,i,j]}{\Delta x} .
            \end{align}\end{subequations}
            %
            Полагая $\varepsilon_r = \mathrm{const}$ во всем пространстве\footnotemark{} и выбирая в качестве шага по времени $\Delta t = \sqrt\varepsilon_r \flatfrac{\Delta x}{2 c_0}$, получим:
            %
            \begin{equation*}
                \frac{1}{\sqrt{\varepsilon_0 \mu_0}} \frac{\Delta t}{\Delta x} = \frac{\sqrt\varepsilon_r}{\sqrt{2}} .
            \end{equation*}
            %
            Симметрично входящий во все уравнения член $\flatfrac{\sqrt\varepsilon_r}{\sqrt{2}}$ можно внести в компоненту $E_z$ поля $\vb{E}$.

            \footnotetext{
                Альтернативно, можно считать $\varepsilon_r = \mathrm{var}$, а шаг по времени рассчитывать исходя из минимального значения $\varepsilon_r$ или из значения $\varepsilon_r = 1$ в вакууме.
            }

            Требование на шаг по времени вполне очевидно. Распространяющаяся в среде волна не может двигаться со скоростью, большей скорости света в этой среде. За время $\Delta t$ свет не должен распространиться дальше, чем на удельный размер одной ячейки.

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsection{Источники излучения}

            Внутренние источники излучения можно разделить на \enquote{мягкие} и \enquote{жесткие}. Жесткие источники вводятся в вычислительную схему очень просто: значение поля $E_z$ в точке нахождения источника приравнивается к значению функции $E^s_z(t)$, описывающей источник.

            Мягкие источники задаются примерно также с тем исключением, что поле источника не заменяет рассчитанное поле в ячейке, а суммируется с ним.

            Жесткие источники являются рассеивающими центрами, потому в задачах о множестве источников, формирующих некий волновой фронт, следует применять мягкие источники, через которые поле других источников \enquote{проходит} без рассеяния.

            Жесткими источниками удобно моделировать, например, идеальные изолирующие слои.

        %
        %
        %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %                        SUBSECTION                               %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %
        %
        %

        \subsection{Граничные условия Беренджера. PML}

            Для устранения переотражений на свободной границе области моделирования используются свободные граничные условия. Наиболее известными и простыми являются PML. Они основываются на введении дополнительных поглощающих слоев у свободных границ, в которых поле затухает без отражения.

            Коэффициент отражения от границы слоев $A$-$B$ определяется формулой:
            %
            \begin{equation}
                \Gamma = \frac{\eta_A - \eta_B}{\eta_A + \eta_B} , \quad
                \eta = \sqrt\frac{\mu}{\varepsilon} .
            \end{equation}
            %
            Условием отсутствия отражения является $\Gamma = 0$, в следствие чего необходимо $\eta_A = \eta_B$. В слое PML также должно обеспечиваться затухание электромагнитного поля, потому и $\varepsilon_B$, и $\mu_B$ должны быть комплексными величинами. Это, в свою очередь, означает наличие токов утечки.

            Задачу расчета поля с PML-слоями решают следующим образом. Вводят фиктивные комплексные величины, $\varepsilon^*_{Fz}(x)$, $\varepsilon^*_{Fz}(y)$, $\mu^*_{Fx}(x)$, $\mu^*_{Fx}(y)$, $\mu^*_{Fy}(x)$ и $\mu^*_{Fy}(y)$, меняющиеся в направлении одной из координат. Эти величины выбирают таким образом, чтобы сохранить отношение $\eta$ при переходе из одной среды в другую. В центре области моделирования эти параметры обращаются в единицы. В PML-слое (толщиной $\sim 16$ ячеек) затухание поля увеличивают в направлении от центра области моделирования по квадратичному или кубическому закону.

            Конкретные выражения и их вывод здесь не приводится в силу громоздкости промежуточных и окончательных результатов. Подробный вывод можно найти в \cite{fdtd_sullivan}.

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Анализ результатов}

        В ходе работы была написана демонстрационная программа (\autoref{fig:mainwindow}) на языке  \enquote{C++}, позволяющая наглядно исследовать динамику электромагнитного поля в рассматриваемой системе.
        %
        \begin{figure}[h]
            \centering
            \includegraphics[width=0.8\textwidth]{mainwindow}
            \caption[]{Главное окно программы}
            \label{fig:mainwindow}
        \end{figure}
        %
        Программа трехмерное изображение компоненты $E_z$ поля на каждом временном шаге во всей области моделирования. Красным цветом изображены положительные значения $E_z$, синим~--- отрицательные.

        На \autoref{fig:1}-\autoref{fig:5} приведены результаты моделирования для различных конфигураций системы.
        %
        \begin{figure}[!htb]%
            \centering
            %
            \subfloat[][]{\includegraphics[width=0.35\textwidth]{1_3d}}%
            \hspace{8pt}%
            %
            \subfloat[][]{\includegraphics[width=0.35\textwidth]{1_2d}}%
            \hspace{8pt}%
            %
            \caption[]{Точечный источник низкой частоты в свободном пространстве.}%
            \label{fig:1}%
        \end{figure}
        %
        \begin{figure}[!htb]%
            \centering
            %
            \subfloat[][]{\includegraphics[width=0.35\textwidth]{2_3d}}%
            \hspace{8pt}%
            %
            \subfloat[][]{\includegraphics[width=0.35\textwidth]{2_2d}}%
            \hspace{8pt}%
            %
            \caption[]{Точечный источник низкой частоты. Дифракция на узкой щели.}%
            \label{fig:2}%
        \end{figure}
        %
        \begin{figure}[!htb]%
            \centering
            %
            \subfloat[][]{\includegraphics[width=0.35\textwidth]{3_3d}}%
            \hspace{8pt}%
            %
            \subfloat[][]{\includegraphics[width=0.35\textwidth]{3_2d}}%
            \hspace{8pt}%
            %
            \caption[]{Точечный источник низкой частоты. Дифракция на широкой щели.}%
            \label{fig:3}%
        \end{figure}
        %
        \begin{figure}[!htb]%
            \centering
            %
            \subfloat[][]{\includegraphics[width=0.35\textwidth]{4_3d}}%
            \hspace{8pt}%
            %
            \subfloat[][]{\includegraphics[width=0.35\textwidth]{4_2d}}%
            \hspace{8pt}%
            %
            \caption[]{Точечный источник высокой частоты. Дифракция на узкой щели.}%
            \label{fig:4}%
        \end{figure}
        %
        \begin{figure}[!htb]%
            \centering
            %
            \subfloat[][]{\includegraphics[width=0.35\textwidth]{5_3d}}%
            \hspace{8pt}%
            %
            \subfloat[][]{\includegraphics[width=0.35\textwidth]{5_2d}}%
            \hspace{8pt}%
            %
            \caption[]{Точечный источник высокой частоты. Дифракция на широкой щели.}%
            \label{fig:5}%
        \end{figure}

        Видно, что в точечный источник низкой частоты почти не дифрагирует на узкой щели (наблюдается единственный дифракционных порядок, хотя электромагнитная волна и \enquote{заполняет} все пространство за ширмой). Это связано с тем, что ширина щели и длина волны источника почти совпадают. На широкой щели уже можно проследить появление дифракционных порядков. Особенно хорошо это различимо в случае источника высокой частоты на широкой щели.

        Кроме того, можно отметить появление интерференционной картины, образованной падающей и отраженной от ширмы волнами вблизи источника.

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Выводы}

        В ходе работы была написана демонстрационная программа, позволяющая исследовать вид дифракционной картины электромагнитного поля от точечного источника на ширме.

        Результаты моделирования классических случаев совпадают с ожидаемыми.


    \bibliographystyle{acm}
    \bibliography{books}

\end{document}
